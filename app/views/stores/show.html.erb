<div class="col-10 offset-1 main">

	<%= link_to favoritestore_text, favoritestores_update_path(store: @store), id: 'favoritestore_link', remote: true, class: 'btn btn-primary' %> &nbsp; Favorited: <%= @store.favoritestores.count %><br /><br />

	<h2><%= @store.storename %></h2>
	<%= @store.address %><br /><br />

	

	Reviews from this dispensary: <%= @store.reviews.count %><br />

	<%# .limit(5) between order and each once there are more reviews per store %>
	<% @store.reviews.order("created_at DESC").each do |review| %>
		<%= link_to review.title, store_review_path(@store, review) %><br />
	<% end %>

	<br /><br />

	<% if @store.reviews.present? && @store.reviews.last.storetype == 'delivery' %>
		<small><em>Locations for Delivery Services are approximate.</em></small><br />
	<% end %>

	<!-- Display map if coordinates are present -->

		<% if @store.latitude.present? && @store.longitude.present? %>

		  <script>
		    function initMap() {
		      var myLatLng = {lat: <%= @store.latitude %>, lng: <%= @store.longitude%>};
		      var map = new google.maps.Map(document.getElementById('map'), {
		        zoom: 13,
		        center: myLatLng
		      });
		      var marker = new google.maps.Marker({
		        position: myLatLng,
		        map: map,
		        title: '<%= @store.storename %>'
		      });
		    }
		  </script>

		  <script async defer
		  src="https://maps.googleapis.com/maps/api/js?key=<%= ENV["GOOGLE_API_KEY"] %>&callback=initMap">
		  </script>

		  <div id="map"></div>

	  <% end %>

	  <!-- END MAP -->

	<br /><br />

	<div class="box">

		<h3>Add a review for a strain from <%= @store.storename %></h3>
		<br />

		<div>
			<%= simple_form_for @review, url: store_reviews_path(@store) do |f| %>
				<%# f.input :producttype, as: :select, collection: Review::PRODUCTTYPE, label: 'What kind of product are you reviewing?' %>
				<%= f.hidden_field :producttype, value: "flower" %>
				<%= f.input :storetype, as: :select, collection: Review::STORETYPE, label: 'Storefront or Delivery Service?' %>
				<%= f.input :title, label: 'Enter a title for your review' %>
				<%= f.input :straintype, as: :select, collection: Review::STRAINTYPE, label: 'What type of strain was it?' %>
				<%= f.input :strainname, label: 'What was the strain called?' %>
				<%= f.input :visualrating, as: :select, collection: 1..10, label: 'How does it look?' %>
				<%= f.input :tasterating, as: :select, collection: 1..10, label: 'How does it taste?' %>
				<%= f.input :odorrating, as: :select, collection: 1..10, label: 'How does it smell?' %>
				<%= f.input :potencyrating, as: :select, collection: 1..10, label: 'How was the potency?' %>
				<%= f.input :happinessrating, as: :select, collection: 1..10, label: 'How happy are you with the purchase?' %>
				<div class="box">
				<%= f.input :clarityrating, as: :range, label: 'Clear or Heavy?' %>
				<small>Clear <span class="float-right">Heavy</span></small>
				</div>
				<div class="box">
				<%= f.input :quicknessrating, as: :range, label: 'Comes on quick or Creeper?' %>
				<small>Comes on quick <span class="float-right">Takes a while</span></small>
				</div>
				<div class="box">
				<%= f.input :headbodyrating, as: :range, label: 'Head or Body?' %>
				<small>Head <span class="float-right">Body</span></small>
				</div>
				<div class="box">
				<%= f.input :daynightrating, as: :range, label: 'Day or Night?' %>
				<small>Day <span class="float-right">Night</span></small>
				</div>
				<%= f.input :comment, label: 'Tell us more about it.' %>
				<br />
				<%= f.submit 'Create Review', class: 'btn btn-primary btn-lg btn-block' %>
			<% end %>
		</div>

	</div>

</div>
